!function(e,t){"function"==typeof define&&define.amd?define([],t):e.StampSDK=t(),e.StampSDK=t()}(window,function(){function e(t){if(!(this instanceof e))return new e(t);if(t||(t={}),!t.consumer)throw new Error("consumer option is required");switch(this.consumer=t.consumer,this.signature_method=t.signature_method||"HMAC-SHA1",this.nonce_length=t.nonce_length||32,this.version=t.version||"1.0",this.parameter_seperator=t.parameter_seperator||", ",this.last_ampersand="undefined"==typeof t.last_ampersand?!0:t.last_ampersand,this.signature_method){case"HMAC-SHA1":this.hash=function(e,t){return o.HmacSHA1(e,t).toString(o.enc.Base64)};break;case"PLAINTEXT":this.hash=function(e,t){return t};break;case"RSA-SHA1":throw new Error("oauth-1.0a does not support this signature method right now. Coming Soon...");default:throw new Error("The OAuth 1.0a protocol defines three signature methods: HMAC-SHA1, RSA-SHA1, and PLAINTEXT only")}}var t,n,r;!function(e){function o(e,t){return _.call(e,t)}function i(e,t){var n,r,o,i,a,s,c,u,p,d,f,l=t&&t.split("/"),h=w.map,v=h&&h["*"]||{};if(e&&"."===e.charAt(0))if(t){for(l=l.slice(0,l.length-1),e=e.split("/"),a=e.length-1,w.nodeIdCompat&&S.test(e[a])&&(e[a]=e[a].replace(S,"")),e=l.concat(e),p=0;p<e.length;p+=1)if(f=e[p],"."===f)e.splice(p,1),p-=1;else if(".."===f){if(1===p&&(".."===e[2]||".."===e[0]))break;p>0&&(e.splice(p-1,2),p-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((l||v)&&h){for(n=e.split("/"),p=n.length;p>0;p-=1){if(r=n.slice(0,p).join("/"),l)for(d=l.length;d>0;d-=1)if(o=h[l.slice(0,d).join("/")],o&&(o=o[r],o)){i=o,s=p;break}if(i)break;!c&&v&&v[r]&&(c=v[r],u=p)}!i&&c&&(i=c,s=u),i&&(n.splice(0,s,i),e=n.join("/"))}return e}function a(t,n){return function(){var r=E.call(arguments,0);return"string"!=typeof r[0]&&1===r.length&&r.push(null),l.apply(e,r.concat([t,n]))}}function s(e){return function(t){return i(t,e)}}function c(e){return function(t){g[e]=t}}function u(t){if(o(m,t)){var n=m[t];delete m[t],y[t]=!0,f.apply(e,n)}if(!o(g,t)&&!o(y,t))throw new Error("No "+t);return g[t]}function p(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function d(e){return function(){return w&&w.config&&w.config[e]||{}}}var f,l,h,v,g={},m={},w={},y={},_=Object.prototype.hasOwnProperty,E=[].slice,S=/\.js$/;h=function(e,t){var n,r=p(e),o=r[0];return e=r[1],o&&(o=i(o,t),n=u(o)),o?e=n&&n.normalize?n.normalize(e,s(t)):i(e,t):(e=i(e,t),r=p(e),o=r[0],e=r[1],o&&(n=u(o))),{f:o?o+"!"+e:e,n:e,pr:o,p:n}},v={require:function(e){return a(e)},exports:function(e){var t=g[e];return"undefined"!=typeof t?t:g[e]={}},module:function(e){return{id:e,uri:"",exports:g[e],config:d(e)}}},f=function(t,n,r,i){var s,p,d,f,l,w,_=[],E=typeof r;if(i=i||t,"undefined"===E||"function"===E){for(n=!n.length&&r.length?["require","exports","module"]:n,l=0;l<n.length;l+=1)if(f=h(n[l],i),p=f.f,"require"===p)_[l]=v.require(t);else if("exports"===p)_[l]=v.exports(t),w=!0;else if("module"===p)s=_[l]=v.module(t);else if(o(g,p)||o(m,p)||o(y,p))_[l]=u(p);else{if(!f.p)throw new Error(t+" missing "+p);f.p.load(f.n,a(i,!0),c(p),{}),_[l]=g[p]}d=r?r.apply(g[t],_):void 0,t&&(s&&s.exports!==e&&s.exports!==g[t]?g[t]=s.exports:d===e&&w||(g[t]=d))}else t&&(g[t]=r)},t=n=l=function(t,n,r,o,i){if("string"==typeof t)return v[t]?v[t](n):u(h(t,n).f);if(!t.splice){if(w=t,w.deps&&l(w.deps,w.callback),!n)return;n.splice?(t=n,n=r,r=null):t=e}return n=n||function(){},"function"==typeof r&&(r=o,o=i),o?f(e,t,n,r):setTimeout(function(){f(e,t,n,r)},4),l},l.config=function(e){return l(e)},t._defined=g,r=function(e,t,n){t&&t.splice||(n=t,t=[]),o(g,e)||o(m,e)||(m[e]=[e,t,n])},r.amd={jQuery:!0}}(),r("lib/util",[],function(){function e(e,n,r){var o,i=n.prototype;o=e.prototype=Object.create(i),o.constructor=e,o._super=i,r&&t(o,r)}function t(e,t,n){for(var r=Object.keys(t),o=0,i=r.length;i>o;o++)(!n||n&&void 0===e[r[o]])&&(e[r[o]]=t[r[o]]);return e}function n(e,n){return t(e,n,!0)}function r(e){var t=Object.prototype.toString,n="<br>",o="&nbsp;",i=8,a="",s=arguments[1]||0,c=function(e){for(var t="";e--;)t+=o;return t}(s);if(!e||"object"!=typeof e&&"function"!=typeof e)a+=e;else if("[object Date]"==t.call(e))a+="[Date] "+e;else if("[object RegExp"==t.call(e))a+="[RegExp] "+e;else if("[object Function]"==t.call(e))a+="[Function] "+e;else if("[object Array]"==t.call(e)){var u=0,p=e.length;for(a+="["+n;p>u;)a+=[c,u,": ",r(e[u],s+i)].join(""),a+="<br>",u++;a+=c+"]"}else{var d;a+="{"+n;for(d in e)a+=[c,d,": ",r(e[d],s+i)].join(""),a+=n;a+=c+"}"}return a}var o={};return o._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o._utf8_encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);128>r?t+=String.fromCharCode(r):r>127&&2048>r?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t},o._utf8_decode=function(e){for(var t="",n=0,r=c1=c2=0;n<e.length;)r=e.charCodeAt(n),128>r?(t+=String.fromCharCode(r),n++):r>191&&224>r?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((31&r)<<6|63&c2),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((15&r)<<12|(63&c2)<<6|63&c3),n+=3);return t},o.encode=function(e){var t,n,r,i,a,s,c,u="",p=0;for(e=o._utf8_encode(e);p<e.length;)t=e.charCodeAt(p++),n=e.charCodeAt(p++),r=e.charCodeAt(p++),i=t>>2,a=(3&t)<<4|n>>4,s=(15&n)<<2|r>>6,c=63&r,isNaN(n)?s=c=64:isNaN(r)&&(c=64),u=u+this._keyStr.charAt(i)+this._keyStr.charAt(a)+this._keyStr.charAt(s)+this._keyStr.charAt(c);return u},o.decode=function(e){var t,n,r,i,a,s,c,u="",p=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");p<e.length;)i=this._keyStr.indexOf(e.charAt(p++)),a=this._keyStr.indexOf(e.charAt(p++)),s=this._keyStr.indexOf(e.charAt(p++)),c=this._keyStr.indexOf(e.charAt(p++)),t=i<<2|a>>4,n=(15&a)<<4|s>>2,r=(3&s)<<6|c,u+=String.fromCharCode(t),64!=s&&(u+=String.fromCharCode(n)),64!=c&&(u+=String.fromCharCode(r));return u=o._utf8_decode(u),u},function(){for(var e,t=function(){},n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],r=n.length,o=window.console=window.console||{};r--;)e=n[r],o[e]||(o[e]=t)}(),{base64:o,uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})},createCORSRequest:function(e,t){var n=new XMLHttpRequest;return"withCredentials"in n?n.open(e,t,!0):"undefined"!=typeof XDomainRequest?(n=new XDomainRequest,n.open(e,t)):n=null,n},getQueryParams:function(){var e=window.location.href.split("?")[1];if(void 0===e)return{};e=e.split("&"),params_map={};for(var t=0;t<e.length;t++){var n=e[t].split("=");params_map[n[0]]=n[1]}return params_map},inherit:e,extend:t,merge:n,pprint:r}});var o=o||function(e,t){var n={},r=n.lib={},o=function(){},i=r.Base={extend:function(e){o.prototype=this;var t=new o;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=r.WordArray=i.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var o=0;e>o;o++)t[r+o>>>2]|=(n[o>>>2]>>>24-8*(o%4)&255)<<24-8*((r+o)%4);else if(65535<n.length)for(o=0;e>o;o+=4)t[r+o>>>2]=n[o>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-8*(n%4),t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;t>r;r+=4)n.push(4294967296*e.random()|0);return new a.init(n,t)}}),s=n.enc={},c=s.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;e>r;r++){var o=t[r>>>2]>>>24-8*(r%4)&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;t>r;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-4*(r%8);return new a.init(n,t/2)}},u=s.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;e>r;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-8*(r%4)&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;t>r;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-8*(r%4);return new a.init(n,t)}},p=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},d=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=p.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,s=o/(4*i),s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0);if(t=s*i,o=e.min(4*t,o),t){for(var c=0;t>c;c+=i)this._doProcessBlock(r,c);c=r.splice(0,t),n.sigBytes-=o}return new a.init(c,o)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=d.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}});var f=n.algo={};return n}(Math);!function(){var e=o,t=e.lib,n=t.WordArray,r=t.Hasher,i=[],t=e.algo.SHA1=r.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],a=n[2],s=n[3],c=n[4],u=0;80>u;u++){if(16>u)i[u]=0|e[t+u];else{var p=i[u-3]^i[u-8]^i[u-14]^i[u-16];i[u]=p<<1|p>>>31}p=(r<<5|r>>>27)+c+i[u],p=20>u?p+((o&a|~o&s)+1518500249):40>u?p+((o^a^s)+1859775393):60>u?p+((o&a|o&s|a&s)-1894007588):p+((o^a^s)-899497514),c=s,s=a,a=o<<30|o>>>2,o=r,r=p}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+a|0,n[3]=n[3]+s|0,n[4]=n[4]+c|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[(r+64>>>9<<4)+14]=Math.floor(n/4294967296),t[(r+64>>>9<<4)+15]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=r._createHelper(t),e.HmacSHA1=r._createHmacHelper(t)}(),function(){var e=o,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,n){e=this._hasher=new e.init,"string"==typeof n&&(n=t.parse(n));var r=e.blockSize,o=4*r;n.sigBytes>o&&(n=e.finalize(n)),n.clamp();for(var i=this._oKey=n.clone(),a=this._iKey=n.clone(),s=i.words,c=a.words,u=0;r>u;u++)s[u]^=1549556828,c[u]^=909522486;i.sigBytes=a.sigBytes=o,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),e.prototype.authorize=function(e,t){var n={oauth_consumer_key:this.consumer.public,oauth_nonce:this.getNonce(),oauth_signature_method:this.signature_method,oauth_timestamp:this.getTimeStamp(),oauth_version:this.version};return t||(t={}),t.public&&(n.oauth_token=t.public),e.data||(e.data={}),n.oauth_signature=this.getSignature(e,t.secret,n),n},e.prototype.getSignature=function(e,t,n){return this.hash(this.getBaseString(e,n),this.getSigningKey(t))},e.prototype.getBaseString=function(e,t){return e.method.toUpperCase()+"&"+this.percentEncode(this.getBaseUrl(e.url))+"&"+this.percentEncode(this.getParameterString(e,t))},e.prototype.getParameterString=function(e,t){var n=this.sortObject(this.percentEncodeData(this.mergeObject(t,this.mergeObject(e.data,this.deParamUrl(e.url))))),r="";for(var o in n)r+=o+"="+n[o]+"&";return r=r.substr(0,r.length-1),r},e.prototype.getSigningKey=function(e){return e=e||"",this.last_ampersand||e?this.percentEncode(this.consumer.secret)+"&"+this.percentEncode(e):this.percentEncode(this.consumer.secret)},e.prototype.getBaseUrl=function(e){return e.split("?")[0]},e.prototype.deParam=function(e){for(var t=decodeURIComponent(e).split("&"),n={},r=0;r<t.length;r++){var o=t[r].split("=");n[o[0]]=o[1]}return n},e.prototype.deParamUrl=function(e){var t=e.split("?");return 1===t.length?{}:this.deParam(t[1])},e.prototype.percentEncode=function(e){return encodeURIComponent(e).replace(/\!/g,"%21").replace(/\*/g,"%2A").replace(/\'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29")},e.prototype.percentEncodeData=function(e){var t={};for(var n in e)t[this.percentEncode(n)]=this.percentEncode(e[n]);return t},e.prototype.toHeader=function(e){e=this.sortObject(e);var t="OAuth ";for(var n in e)-1!==n.indexOf("oauth_")&&(t+=this.percentEncode(n)+'="'+this.percentEncode(e[n])+'"'+this.parameter_seperator);return{Authorization:t.substr(0,t.length-this.parameter_seperator.length)}},e.prototype.getNonce=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",t="",n=0;n<this.nonce_length;n++)t+=e[parseInt(Math.random()*e.length,10)];return t},e.prototype.getTimeStamp=function(){return parseInt((new Date).getTime()/1e3,10)},e.prototype.mergeObject=function(e,t){var n=e;for(var r in t)n[r]=t[r];return n},e.prototype.sortObject=function(e){var t=Object.keys(e),n={};t.sort();for(var r=0;r<t.length;r++){var o=t[r];n[o]=e[o]}return n},r("lib/oauth",function(){});var i=i||{};return function(){function e(){C=!0,clearTimeout(L),L=setTimeout(function(){C=!1},700)}function t(e){var t=[];if(e)for(t.unshift(e);e.parentNode;)t.unshift(e.parentNode),e=e.parentNode;return t}function n(e,n){for(var r=t(e),o=t(n),i=null;r.length>0&&r[0]==o.shift();)i=r.shift();return i}function r(e,t,r){for(var o=n(e,t),i=e,a=[];i&&i!=o;)m(i,"pointerenter")&&a.push(i),i=i.parentNode;for(;a.length>0;)r(a.pop())}function o(e,t,r){for(var o=n(e,t),i=e;i&&i!=o;)m(i,"pointerleave")&&r(i),i=i.parentNode}function a(e,t){["pointerdown","pointermove","pointerup","pointerover","pointerout"].forEach(function(n){window.addEventListener(e(n),function(e){!C&&w(e.target,n)&&t(e,n,!0)})}),void 0===window["on"+e("pointerenter").toLowerCase()]&&window.addEventListener(e("pointerover"),function(e){if(!C){var n=w(e.target,"pointerenter");n&&n!==window&&(n.contains(e.relatedTarget)||r(n,e.relatedTarget,function(n){t(e,"pointerenter",!1,n,e.relatedTarget)}))}}),void 0===window["on"+e("pointerleave").toLowerCase()]&&window.addEventListener(e("pointerout"),function(e){if(!C){var n=w(e.target,"pointerleave");n&&n!==window&&(n.contains(e.relatedTarget)||o(n,e.relatedTarget,function(n){t(e,"pointerleave",!1,n,e.relatedTarget)}))}})}if(!window.PointerEvent){Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=Object(this),n=t.length>>>0;if(0===n)return-1;var r=0;if(arguments.length>0&&(r=Number(arguments[1]),r!=r?r=0:0!=r&&1/0!=r&&r!=-1/0&&(r=(r>0||-1)*Math.floor(Math.abs(r)))),r>=n)return-1;for(var o=r>=0?r:Math.max(n-Math.abs(r),0);n>o;o++)if(o in t&&t[o]===e)return o;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){if(!(this&&e instanceof Function))throw new TypeError;for(var n=0;n<this.length;n++)e.call(t,this[n],n,this)}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/,"")});var s=["pointerdown","pointerup","pointermove","pointerover","pointerout","pointercancel","pointerenter","pointerleave"],c=["PointerDown","PointerUp","PointerMove","PointerOver","PointerOut","PointerCancel","PointerEnter","PointerLeave"],u="touch",p="pen",d="mouse",f={},l=function(e){for(;e&&!e.handjs_forcePreventDefault;)e=e.parentNode;return!!e||window.handjs_forcePreventDefault},h=function(e,t,n,r,o){var i;if(document.createEvent?(i=document.createEvent("MouseEvents"),i.initMouseEvent(t,n,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,o||e.relatedTarget)):(i=document.createEventObject(),i.screenX=e.screenX,i.screenY=e.screenY,i.clientX=e.clientX,i.clientY=e.clientY,i.ctrlKey=e.ctrlKey,i.altKey=e.altKey,i.shiftKey=e.shiftKey,i.metaKey=e.metaKey,i.button=e.button,i.relatedTarget=o||e.relatedTarget),void 0===i.offsetX&&(void 0!==e.offsetX?(Object&&void 0!==Object.defineProperty&&(Object.defineProperty(i,"offsetX",{writable:!0}),Object.defineProperty(i,"offsetY",{writable:!0})),i.offsetX=e.offsetX,i.offsetY=e.offsetY):Object&&void 0!==Object.defineProperty?(Object.defineProperty(i,"offsetX",{get:function(){return this.currentTarget&&this.currentTarget.offsetLeft?e.clientX-this.currentTarget.offsetLeft:e.clientX}}),Object.defineProperty(i,"offsetY",{get:function(){return this.currentTarget&&this.currentTarget.offsetTop?e.clientY-this.currentTarget.offsetTop:e.clientY}})):void 0!==e.layerX&&(i.offsetX=e.layerX-e.currentTarget.offsetLeft,i.offsetY=e.layerY-e.currentTarget.offsetTop)),i.isPrimary=void 0!==e.isPrimary?e.isPrimary:!0,e.pressure)i.pressure=e.pressure;else{var a=0;void 0!==e.which?a=e.which:void 0!==e.button&&(a=e.button),i.pressure=0==a?0:.5}if(i.rotation=e.rotation?e.rotation:0,i.hwTimestamp=e.hwTimestamp?e.hwTimestamp:0,i.tiltX=e.tiltX?e.tiltX:0,i.tiltY=e.tiltY?e.tiltY:0,i.height=e.height?e.height:0,i.width=e.width?e.width:0,i.preventDefault=function(){void 0!==e.preventDefault&&e.preventDefault()},void 0!==i.stopPropagation){var s=i.stopPropagation;i.stopPropagation=function(){void 0!==e.stopPropagation&&e.stopPropagation(),s.call(this)}}switch(i.pointerId=e.pointerId,i.pointerType=e.pointerType,i.pointerType){case 2:i.pointerType=u;break;case 3:i.pointerType=p;break;case 4:i.pointerType=d}r?r.dispatchEvent(i):e.target?e.target.dispatchEvent(i):e.srcElement.fireEvent("on"+_(t),i)},v=function(e,t,n,r,o){e.pointerId=1,e.pointerType=d,h(e,t,n,r,o)},g=function(e,t,n,r,o,i){var a=t.identifier+2;t.pointerId=a,t.pointerType=u,t.currentTarget=n,void 0!==r.preventDefault&&(t.preventDefault=function(){r.preventDefault()}),h(t,e,o,n,i)},m=function(e,t){return e.__handjsGlobalRegisteredEvents&&e.__handjsGlobalRegisteredEvents[t]},w=function(e,t){for(;e&&!m(e,t);)e=e.parentNode;return e?e:m(window,t)?window:void 0},y=function(e,t,n,r,o,i){w(n,e)&&g(e,t,n,r,o,i)},_=function(e){return e.toLowerCase().replace("pointer","mouse")},E=function(e,t){var n=s.indexOf(t),r=e+c[n];return r},S=function(e,t,n,r){if(void 0===e.__handjsRegisteredEvents&&(e.__handjsRegisteredEvents=[]),r){if(void 0!==e.__handjsRegisteredEvents[t])return e.__handjsRegisteredEvents[t]++,void 0;e.__handjsRegisteredEvents[t]=1,e.addEventListener(t,n,!1)}else{if(-1!==e.__handjsRegisteredEvents.indexOf(t)&&(e.__handjsRegisteredEvents[t]--,0!=e.__handjsRegisteredEvents[t]))return;e.removeEventListener(t,n),e.__handjsRegisteredEvents[t]=0}},T=function(e,t,n){if(e.__handjsGlobalRegisteredEvents||(e.__handjsGlobalRegisteredEvents=[]),n){if(void 0!==e.__handjsGlobalRegisteredEvents[t])return e.__handjsGlobalRegisteredEvents[t]++,void 0;e.__handjsGlobalRegisteredEvents[t]=1}else void 0!==e.__handjsGlobalRegisteredEvents[t]&&(e.__handjsGlobalRegisteredEvents[t]--,e.__handjsGlobalRegisteredEvents[t]<0&&(e.__handjsGlobalRegisteredEvents[t]=0));var r,o;switch(window.MSPointerEvent?(r=function(e){return E("MS",e)},o=h):(r=_,o=v),t){case"pointerenter":case"pointerleave":var i=r(t);void 0!==e["on"+i.toLowerCase()]&&S(e,i,function(e){o(e,t)},n)}},b=function(e){var t=e.prototype?e.prototype.addEventListener:e.addEventListener,n=function(e,n,r){-1!=s.indexOf(e)&&T(this,e,!0),void 0===t?this.attachEvent("on"+_(e),n):t.call(this,e,n,r)};e.prototype?e.prototype.addEventListener=n:e.addEventListener=n},x=function(e){var t=e.prototype?e.prototype.removeEventListener:e.removeEventListener,n=function(e,n,r){-1!=s.indexOf(e)&&T(this,e,!1),void 0===t?this.detachEvent(_(e),n):t.call(this,e,n,r)};e.prototype?e.prototype.removeEventListener=n:e.removeEventListener=n};b(window),b(window.HTMLElement||window.Element),b(document),b(HTMLBodyElement),b(HTMLDivElement),b(HTMLImageElement),b(HTMLUListElement),b(HTMLAnchorElement),b(HTMLLIElement),b(HTMLTableElement),window.HTMLSpanElement&&b(HTMLSpanElement),window.HTMLCanvasElement&&b(HTMLCanvasElement),window.SVGElement&&b(SVGElement),x(window),x(window.HTMLElement||window.Element),x(document),x(HTMLBodyElement),x(HTMLDivElement),x(HTMLImageElement),x(HTMLUListElement),x(HTMLAnchorElement),x(HTMLLIElement),x(HTMLTableElement),window.HTMLSpanElement&&x(HTMLSpanElement),window.HTMLCanvasElement&&x(HTMLCanvasElement),window.SVGElement&&x(SVGElement);var C=!1,L=-1;!function(){window.MSPointerEvent?a(function(e){return E("MS",e)},h):(a(_,v),void 0!==window.ontouchstart&&(window.addEventListener("touchstart",function(t){for(var n=0;n<t.changedTouches.length;++n){var o=t.changedTouches[n];f[o.identifier]=o.target,y("pointerover",o,o.target,t,!0),r(o.target,null,function(e){g("pointerenter",o,e,t,!1)}),y("pointerdown",o,o.target,t,!0)}e()}),window.addEventListener("touchend",function(t){for(var n=0;n<t.changedTouches.length;++n){var r=t.changedTouches[n],i=f[r.identifier];y("pointerup",r,i,t,!0),y("pointerout",r,i,t,!0),o(i,null,function(e){g("pointerleave",r,e,t,!1)})}e()}),window.addEventListener("touchmove",function(t){for(var n=0;n<t.changedTouches.length;++n){var i=t.changedTouches[n],a=document.elementFromPoint(i.clientX,i.clientY),s=f[i.identifier];s&&l(s)===!0&&t.preventDefault(),y("pointermove",i,s,t,!0),s!==a&&(s&&(y("pointerout",i,s,t,!0,a),s.contains(a)||o(s,a,function(e){g("pointerleave",i,e,t,!1,a)})),a&&(y("pointerover",i,a,t,!0,s),a.contains(s)||r(a,s,function(e){g("pointerenter",i,e,t,!1,s)})),f[i.identifier]=a)}e()}),window.addEventListener("touchcancel",function(e){for(var t=0;t<e.changedTouches.length;++t){var n=e.changedTouches[t];y("pointercancel",n,f[n.identifier],e,!0)}})))}(),void 0===navigator.pointerEnabled&&(navigator.pointerEnabled=!0,navigator.msPointerEnabled&&(navigator.maxTouchPoints=navigator.msMaxTouchPoints)),document.styleSheets&&document.addEventListener&&document.addEventListener("DOMContentLoaded",function(){if(!i.doNotProcessCSS&&void 0===document.body.style.touchAction){var e=new RegExp(".+?{.*?}","m"),t=new RegExp(".+?{","m"),n=function(n){var r=e.exec(n);if(r){var o=r[0];n=n.replace(o,"").trim();var i=t.exec(o)[0].replace("{","").trim();if(-1!=o.replace(/\s/g,"").indexOf("touch-action:none"))for(var a=document.querySelectorAll(i),s=0;s<a.length;s++){var c=a[s];void 0!==c.style.msTouchAction?c.style.msTouchAction="none":c.handjs_forcePreventDefault=!0}return n}},r=function(e){if(window.setImmediate)e&&setImmediate(r,n(e));else for(;e;)e=n(e)};try{for(var o=0;o<document.styleSheets.length;o++){var a=document.styleSheets[o];if(void 0!=a.href){var s=new XMLHttpRequest;s.open("get",a.href),s.send();var c=s.responseText.replace(/(\n|\r)/g,"");r(c)}}}catch(u){}for(var p=document.getElementsByTagName("style"),o=0;o<p.length;o++){var d=p[o],f=d.innerHTML.replace(/(\n|\r)/g,"").trim();r(f)}}},!1)}}(),r("lib/handjs-1.8.3",function(){}),r("stampsdk",["lib/util","lib/oauth","lib/handjs-1.8.3"],function(t){"use strict";var n,r,o,i=1,a="http://dev2.snowshoestamp.com/",s=a+"api/v2/stamp",c=500,u=500,p=5,d={},f=function(e){var n=this;n.options=t.merge(e||{},n.defaults),n.spotId=n.options.spotId,n.stampSerial=n.options.stampSerial,n.setStampSerial=function(e){n.stampSerial=e}},l=function(i,a){var d=this;d.options=t.merge(i||{},d.defaults),d.stamps=[],d.spotId=d.options.spotId,d.success=d.options.success,d.failure=d.options.failure,d.pre=i.pre,d._pressBegun=(new Date).getTime(),d._points={},d._lastStamped=void 0,d.onSuccess=function(e){void 0!==n&&n.track("stampscreen",{type:"successful stamp",details:e}),d.success(e)},d.onFailure=function(e){void 0!==n&&n.track("stampscreen",{type:"failed stamp",details:e}),d.failure(e)},d._resetPoints=function(){d._points={}},d._getPointCoords=function(){var e=[];for(var t in d._points)e.push([d._points[t].clientX,d._points[t].clientY]);return e},d._validate=function(n){var i,a,c=t.createCORSRequest("POST",s),u=new FormData,p=new e({consumer:{secret:o,"public":r}}),l=function(){try{var e=JSON.parse(c.response),t=e.stamp,n=void 0!==t?t.serial:void 0,r=!1;if(void 0===n)return console.error(o.message),d.onFailure(e),void 0;match=d.stamps.filter(function(e){return e.stampSerial===n}),match&&1===match.length?(match[0].pressed(),r=!0):d.stamps.push(new f({spotId:d.spotId,stampSerial:void 0!==n?n:void 0})),d._lastStamped=now,d.onSuccess(e)}catch(o){return d.onFailure(e),void 0}},h=function(){var e=c.response;d.onFailure(e)};d.pre(n,function(){if(null===c)throw new Error("CORSNotSupported");c.withCredentials=!0,c.onerror=h,c.onload=l,i=p.authorize({url:s,method:"POST",data:u}),a=p.toHeader(i),c.setRequestHeader("Authorization",a.Authorization),c.send(i),u.append("data",t.base64.encode(JSON.stringify(n)))})},d._pointdown=function(e){var r,o=(new Date).getTime(),i=([e.clientX,e.clientY],o-d._pressBegun),a=o-d._lastStamped,s=void 0===d._lastStamped||a>u,f=c>i;e.preventDefault(),f||(d._resetPoints(),d._pressBegun=(new Date).getTime()),r=d._getPointCoords(),void 0===d._points[e.pointerId]&&s&&(r.push([e.clientX,e.clientY]),d._points[e.pointerId]=t.extend({},e,!0),r.length===p&&(void 0!==n&&n.track("stampscreen",{type:"points captured"}),d._validate(r),d._resetPoints()))},d._pointup=function(e){d._points[e.pointerId]&&delete d._points[e.pointerId]},d._pointmove=function(e){d._points[e.pointerId]&&(d._points[e.pointerId].clientX=e.clientX,d._points[e.pointerId].clientY=e.clientY)},d.options.spot.addEventListener("pointerup",d._pointup,!1),d.options.spot.addEventListener("pointerdown",d._pointdown,!1),d.options.spot.addEventListener("pointermove",d._pointmove,!1),void 0!==a&&Function.isFunction(a)&&a()},h=function(e){return e=e?e:{},r=e.clientId?e.clientId:void 0,o=e.clientSecret?e.clientSecret:void 0,e.collectUsageData===!1&&(n=void 0),void 0!==e.oauthVersion||1===e.oauthVersion?i=1:2===e.oauthVersion&&(OAUTH_VERION=2),{makeSpot:v}},v=function(e,t){if(void 0===e.spot)throw new Error("No spot element was passed in.");if(void 0===e.success)throw new Error("No success handler was passed in.");if(void 0===e.failure)throw new Error("No failure handler was passed in.");{var r=new l(e,t);r.spotId}return void 0!==n&&n.track("spot",{type:"init"}),d[r.spotId]=r,r},g=function(){};return g.prototype={status:""},t.inherit(l,g,{defaults:{spot:document.getElementsByTagName("body")[0],spotId:t.uuid()}}),t.inherit(f,g,{defaults:{spotId:t.uuid()}}),{init:h,util:t}}),n("stampsdk")});
//# sourceMappingURL=stampsdk.js.map